!function(){"use strict";var e={};function t(e,t,n,o,r,c,i){try{var a=e[c](i),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(o,r)}function n(e){return function(){var n=this,o=arguments;return new Promise((function(r,c){var i=e.apply(n,o);function a(e){t(i,r,c,a,s,"next",e)}function s(e){t(i,r,c,a,s,"throw",e)}a(void 0)}))}}function o(){return r.apply(this,arguments)}function r(){return(r=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Office.context.mailbox.item.body.getAsync("text",{asyncContext:"This is passed to the callback"},(function(e){document.getElementById("item-subject").innerHTML="<b>Body:</b> <br/>"+e.value;var t=e.value;console.log(t);var n=t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()""]/g," ");console.log(n);var o=n.replace(/\s{2,}/g," ");console.log(o);var r=o.slice(0,-1).split(" ").join("+")+o.slice(-1);console.log(r);var c="https://outlook-addin-aeiou.herokuapp.com/predict?textbody="+r.toLowerCase();console.log(c);var i=new XMLHttpRequest;i.open("GET",c,!1),i.send(null);var a=i.responseText;if(console.log(a),"0"==a)document.getElementById("item-subject").innerHTML="Not a meeting!";else{document.getElementById("item-subject").innerHTML="Meeting detected!";var s=new Date,l=new Date;l.setHours(s.getHours()+1),Office.context.mailbox.displayNewAppointmentForm({start:s,end:l,location:"",subject:Office.context.mailbox.item.subject,body:e.value})}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Office.onReady((function(e){e.host===Office.HostType.Outlook&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=o)}))}();
//# sourceMappingURL=taskpane.js.map