Type.registerNamespace("NLG.Common");var NLG=window.NLG||{};NLG.Common=NLG.Common||{};NLG.Common.ItemFlagStatus=function(){};NLG.Common.ItemFlagStatus.prototype={notFlagged:0,markedComplete:1,flagged:2};NLG.Common.ItemFlagStatus.registerEnum("NLG.Common.ItemFlagStatus",!1);NLG.Common.IEwsRequestArgs=function(){};NLG.Common.IEwsRequestArgs.registerInterface("NLG.Common.IEwsRequestArgs");NLG.Common.AnimationOrigin=function(){};NLG.Common.AnimationOrigin.prototype={none:0,up:1,right:2,down:3,left:4};NLG.Common.AnimationOrigin.registerEnum("NLG.Common.AnimationOrigin",!1);NLG.Common.UpdateItemRequestArgs=function(){};NLG.Common.UpdateItemRequestArgs.prototype={exchangeItemId:null,onCompleteAction:null,originalRequestArgs:null};NLG.Common.GetItemFlagStatusArgs=function(){};NLG.Common.GetItemFlagStatusArgs.prototype={exchangeItemId:null,_onSuccessCallback$p$0:null,_onFailCallback$p$0:null,_timeOutId$p$0:0,get_onSuccessCallback:function(){return this._onSuccessCallback$p$0},set_onSuccessCallback:function(n){this._onSuccessCallback$p$0=n;return n},get_onFailCallback:function(){return this._onFailCallback$p$0},set_onFailCallback:function(n){this._onFailCallback$p$0=n;return n},get_timeOutId:function(){return this._timeOutId$p$0},set_timeOutId:function(n){this._timeOutId$p$0=n;return n}};NLG.Common.SetFlagArgs=function(){};NLG.Common.SetFlagArgs.prototype={exchangeItemId:null,toDoTitle:null,flagStatus:0,_onSuccessCallback$p$0:null,_onFailCallback$p$0:null,_timeOutId$p$0:0,get_onSuccessCallback:function(){return this._onSuccessCallback$p$0},set_onSuccessCallback:function(n){this._onSuccessCallback$p$0=n;return n},get_onFailCallback:function(){return this._onFailCallback$p$0},set_onFailCallback:function(n){this._onFailCallback$p$0=n;return n},get_timeOutId:function(){return this._timeOutId$p$0},set_timeOutId:function(n){this._timeOutId$p$0=n;return n}};NLG.Common.EwsHelper=function(n){this.$$d__wasRequestSuccessful$p$0=Function.createDelegate(this,this._wasRequestSuccessful$p$0);this.$$d__processGetChangeKeyRequest$p$0=Function.createDelegate(this,this._processGetChangeKeyRequest$p$0);this.$$d__removeFlagFromItemCall$p$0=Function.createDelegate(this,this._removeFlagFromItemCall$p$0);this.$$d__setFlagOnItemCall$p$0=Function.createDelegate(this,this._setFlagOnItemCall$p$0);this.$$d__processGetFlagStatusRequest$p$0=Function.createDelegate(this,this._processGetFlagStatusRequest$p$0);this._pendingRequests$p$0=[];this._outlookOm$p$0=n};NLG.Common.EwsHelper.prototype={_outlookOm$p$0:null,getItemFlagStatus:function(n){var i="<?xml version='1.0' encoding='utf-8'?><soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:m='http://schemas.microsoft.com/exchange/services/2006/messages' xmlns:t='http://schemas.microsoft.com/exchange/services/2006/types' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Header><t:RequestServerVersion Version='Exchange2010' /></soap:Header><soap:Body><m:GetItem><m:ItemShape><t:BaseShape>IdOnly</t:BaseShape><t:AdditionalProperties><t:ExtendedFieldURI PropertyTag='0x1090' PropertyType='Integer' /></t:AdditionalProperties></m:ItemShape><m:ItemIds><t:ItemId Id='"+n.exchangeItemId+"' />"+"</m:ItemIds>"+"</m:GetItem>"+"</soap:Body>"+"</soap:Envelope>";var t=this;n._timeOutId$p$0=window.setTimeout(function(){n._onFailCallback$p$0("The request timed out");t._setRequestComplete$p$0(n)},6e3);this._pendingRequests$p$0[this._pendingRequests$p$0.length]=n._timeOutId$p$0;try{this._outlookOm$p$0.makeEwsRequestAsync(i,this._createOptionsParameter$p$0(n),this.$$d__processGetFlagStatusRequest$p$0)}catch(r){n._onFailCallback$p$0(r.message);this._setRequestComplete$p$0(n)}},setFlagOnItem:function(n){var i=this;n._timeOutId$p$0=window.setTimeout(function(){n._onFailCallback$p$0("The request timed out");i._setRequestComplete$p$0(n)},6e3);this._pendingRequests$p$0[this._pendingRequests$p$0.length]=n._timeOutId$p$0;var t=new NLG.Common.UpdateItemRequestArgs;t.exchangeItemId=n.exchangeItemId;t.originalRequestArgs=n;t.onCompleteAction=n.flagStatus===1||n.flagStatus===2?this.$$d__setFlagOnItemCall$p$0:this.$$d__removeFlagFromItemCall$p$0;this._getChangeKeyCall$p$0(t)},_processGetFlagStatusRequest$p$0:function(n){var i=0;var u=!1;if(this._isRequestPending$p$0(n.asyncContext)){if(!n.error)try{var r=NLG.Common.XmlDomDocument.fromString(n.value);var t=r.getElementsByTagName("Value").length>0?r.getElementsByTagName("Value")[0]:r.getElementsByTagName("t:Value")[0];if(this._isValidResponse$p$0(n)){var f=t?t.textContent||t.text||t.innerText:"0";switch(f){case"0":i=0;break;case"1":i=1;break;case"2":i=2;break}u=!0}}catch(e){u=!1}u?n.asyncContext._onSuccessCallback$p$0(i):n.asyncContext._onFailCallback$p$0(n);this._setRequestComplete$p$0(n.asyncContext)}},_getChangeKeyCall$p$0:function(n){var t="<?xml version='1.0' encoding='utf-8'?><soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:m='http://schemas.microsoft.com/exchange/services/2006/messages' xmlns:t='http://schemas.microsoft.com/exchange/services/2006/types' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Header><t:RequestServerVersion Version='Exchange2010' /></soap:Header><soap:Body><m:GetItem><m:ItemShape><t:BaseShape>IdOnly</t:BaseShape></m:ItemShape><m:ItemIds><t:ItemId Id='"+n.exchangeItemId+"' />"+"</m:ItemIds>"+"</m:GetItem>"+"</soap:Body>"+"</soap:Envelope>";try{this._outlookOm$p$0.makeEwsRequestAsync(t,this._createOptionsParameter$p$0(n),this.$$d__processGetChangeKeyRequest$p$0)}catch(i){n.originalRequestArgs.get_onFailCallback()(i.message);this._setRequestComplete$p$0(n.originalRequestArgs)}},_processGetChangeKeyRequest$p$0:function(n){var r="";var i=!1;if(this._isRequestPending$p$0(n.asyncContext.originalRequestArgs)){if(!n.error&&this._isValidResponse$p$0(n)){var t=NLG.Common.XmlDomDocument.fromString(n.value);try{var u=t.getElementsByTagName("ItemId").length>0?t.getElementsByTagName("ItemId")[0]:t.getElementsByTagName("t:ItemId")[0];r=u.attributes.getNamedItem("ChangeKey").value;i=!0}catch(f){i=!1}}if(i)n.asyncContext.onCompleteAction(n.asyncContext.originalRequestArgs,r);else n.asyncContext.originalRequestArgs.get_onFailCallback()(n);this._setRequestComplete$p$0(n.asyncContext.originalRequestArgs)}},_isRequestPending$p$0:function(n){for(var t=0;t<this._pendingRequests$p$0.length;t++)if(this._pendingRequests$p$0[t]===n.get_timeOutId())return!0;return!1},_setRequestComplete$p$0:function(n){for(var t=0;t<this._pendingRequests$p$0.length;t++)if(this._pendingRequests$p$0[t]===n.get_timeOutId()){this._pendingRequests$p$0.splice(t,1);window.clearTimeout(n.get_timeOutId())}},_wasRequestSuccessful$p$0:function(n){var t=this._isValidResponse$p$0(n);t?n.asyncContext.get_onSuccessCallback()(n):n.asyncContext.get_onFailCallback()(n)},_isValidResponse$p$0:function(n){var r=!1;try{var t=NLG.Common.XmlDomDocument.fromString(n.value);var f=t.getElementsByTagName("ResponseCode").length>0?t.getElementsByTagName("ResponseCode")[0]:t.getElementsByTagName("m:ResponseCode")[0];var e=f.firstChild.nodeValue;var i=t.getElementsByTagName("CreateItemResponseMessage").length>0?t.getElementsByTagName("CreateItemResponseMessage")[0]:t.getElementsByTagName("m:CreateItemResponseMessage")[0];i||(i=t.getElementsByTagName("UpdateItemResponseMessage").length>0?t.getElementsByTagName("UpdateItemResponseMessage")[0]:t.getElementsByTagName("m:UpdateItemResponseMessage")[0]);i||(i=t.getElementsByTagName("GetItemResponseMessage").length>0?t.getElementsByTagName("GetItemResponseMessage")[0]:t.getElementsByTagName("m:GetItemResponseMessage")[0]);var u=i.attributes.getNamedItem("ResponseClass").value;u==="Success"&&e==="NoError"&&(r=!0)}catch(o){r=!1}return r},_setFlagOnItemCall$p$0:function(n,t){var i=n;var r="<?xml version='1.0' encoding='utf-8'?><soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:m='http://schemas.microsoft.com/exchange/services/2006/messages' xmlns:t='http://schemas.microsoft.com/exchange/services/2006/types' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xs='http://www.w3.org/2001/XMLSchema'><soap:Header><t:RequestServerVersion Version='Exchange2010' /></soap:Header><soap:Body><UpdateItem ConflictResolution='AlwaysOverwrite' MessageDisposition='SaveOnly' xmlns='http://schemas.microsoft.com/exchange/services/2006/messages'><ItemChanges><ItemChange xmlns='http://schemas.microsoft.com/exchange/services/2006/types'><ItemId Id='"+i.exchangeItemId+"' ChangeKey='"+t+"' />"+"<Updates>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33025' PropertyType='Long' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33025' PropertyType='Long' />"+"<Value>"+(i.flagStatus===1?2:0)+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34096' PropertyType='String' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34096' PropertyType='String' />"+"<Value>Follow up</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33026' PropertyType='Double' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33026' PropertyType='Double' />"+"<Value>"+(i.flagStatus===1?1:0)+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33052' PropertyType='Boolean' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33052' PropertyType='Boolean' />"+"<Value>"+(i.flagStatus===1).toString()+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='"+(i.flagStatus===1?"32867":"34208")+"' PropertyType='SystemTime' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='"+(i.flagStatus===1?"32867":"34208")+"' PropertyType='SystemTime' />"+"<Value>"+this._getISODateString$p$0(new Date)+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34209' PropertyType='String' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34209' PropertyType='String' />"+"<Value>5555555</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34212' PropertyType='String' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34212' PropertyType='String' />"+"<Value>"+this._xmlEncode$p$0(i.toDoTitle)+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertyTag='0x1095' PropertyType='Integer' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertyTag='0x1095' PropertyType='Integer' />"+"<Value>"+(i.flagStatus===1?0:6)+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertyTag='0x1090' PropertyType='Integer' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertyTag='0x1090' PropertyType='Integer' />"+"<Value>"+(i.flagStatus===1?1:2)+"</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"<SetItemField>"+"<ExtendedFieldURI PropertyTag='0x0E2B' PropertyType='Integer' />"+"<Item>"+"<ExtendedProperty>"+"<ExtendedFieldURI PropertyTag='0x0E2B' PropertyType='Integer' />"+"<Value>1</Value>"+"</ExtendedProperty>"+"</Item>"+"</SetItemField>"+"</Updates>"+"</ItemChange>"+"</ItemChanges>"+"</UpdateItem>"+"</soap:Body>"+"</soap:Envelope>";try{this._outlookOm$p$0.makeEwsRequestAsync(r,this._createOptionsParameter$p$0(i),this.$$d__wasRequestSuccessful$p$0)}catch(u){i._onFailCallback$p$0(u.message);this._setRequestComplete$p$0(i)}},_removeFlagFromItemCall$p$0:function(n,t){var i=n;var r="<?xml version='1.0' encoding='utf-8'?><soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:m='http://schemas.microsoft.com/exchange/services/2006/messages' xmlns:t='http://schemas.microsoft.com/exchange/services/2006/types' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xs='http://www.w3.org/2001/XMLSchema'><soap:Header><t:RequestServerVersion Version='Exchange2010' /></soap:Header><soap:Body><UpdateItem ConflictResolution='AlwaysOverwrite' MessageDisposition='SaveOnly' xmlns='http://schemas.microsoft.com/exchange/services/2006/messages'><ItemChanges><ItemChange xmlns='http://schemas.microsoft.com/exchange/services/2006/types'><ItemId Id='"+i.exchangeItemId+"' ChangeKey='"+t+"' />"+"<Updates>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33025' PropertyType='Long' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34096' PropertyType='String' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33026' PropertyType='Double' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='33052' PropertyType='Boolean' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34208' PropertyType='SystemTime' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='32867' PropertyType='SystemTime' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34209' PropertyType='String' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertySetId='00062008-0000-0000-C000-000000000046' PropertyId='34212' PropertyType='String' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertyTag='0x1095' PropertyType='Integer' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertyTag='0x1090' PropertyType='Integer' />"+"</DeleteItemField>"+"<DeleteItemField>"+"<ExtendedFieldURI PropertyTag='0x0E2B' PropertyType='Integer' />"+"</DeleteItemField>"+"</Updates>"+"</ItemChange>"+"</ItemChanges>"+"</UpdateItem>"+"</soap:Body>"+"</soap:Envelope>";try{this._outlookOm$p$0.makeEwsRequestAsync(r,this._createOptionsParameter$p$0(i),this.$$d__wasRequestSuccessful$p$0)}catch(u){i._onFailCallback$p$0(u.message);this._setRequestComplete$p$0(i)}},_xmlEncode$p$0:function(n){return n.replace("&","&amp;").replace('"',"&quot;").replace("'","&apos;").replace("<","&lt;").replace(">","&gt;")},_getISODateString$p$0:function(n){return n.getUTCFullYear()+""+"-"+this._padDate$p$0(n.getUTCMonth()+1)+"-"+this._padDate$p$0(n.getUTCDate())+"T"+this._padDate$p$0(n.getUTCHours())+":"+this._padDate$p$0(n.getUTCMinutes())+":"+this._padDate$p$0(n.getUTCSeconds())+"Z"},_padDate$p$0:function(n){return n<10?"0"+n:n.toString()},_createOptionsParameter$p$0:function(n){return{asyncContext:n}}};NLG.Common.Frame=function(n,t,i,r){this.name=n;this.content=t;this.onLoad=i;this.dispose=r};NLG.Common.Frame.prototype={name:null,content:null,onLoad:null,dispose:null};NLG.Common.FrameHost=function(n){this._pendingFrames$p$0=[];this._hostDiv$p$0=n};NLG.Common.FrameHost.prototype={_hostDiv$p$0:null,_currentFrame$p$0:null,_isBusy$p$0:!1,renderFrame:function(n,t,i){if(this._isBusy$p$0){Array.enqueue(this._pendingFrames$p$0,new NLG.Common.FrameHost._pendingFrame(n,t,i));return}this._isBusy$p$0=!0;var o;var r;this._hostDiv$p$0.css("overflow","hidden");if(t){r=t===2||t===3?"-100%":"100%";o=i?"0%":t===2||t===3?"100%":"-100%"}else{o="0%";r="0%"}this._hostDiv$p$0.css("overflow","hidden");this._hostDiv$p$0.append("<div id='nextFrame' style='position:relative; left:"+(t===4||t===2?o:"0%")+"; "+"top:"+(t===1||t===3?o:"0%")+"; "+"width:100%; height:100%; opacity:0; -webkit-transition: opacity 1000ms;'></div>");this._hostDiv$p$0.find("#nextFrame").append(n.content);if(this._currentFrame$p$0){this._hostDiv$p$0.find("#currentFrame").css("position","relative");if(i){this._hostDiv$p$0.find("#currentFrame").css("z-index","2");this._hostDiv$p$0.find("#nextFrame").css("z-index","1")}var u;if($.browser.webkit){i||this._hostDiv$p$0.find("#currentFrame").css("opacity","0");u=t===1||t===3?{top:r}:{left:r}}else u=t===1||t===3?i?{top:r}:{top:r,opacity:"0"}:i?{left:r}:{left:r,opacity:"0"};var s=this;this._hostDiv$p$0.find("#currentFrame").attr("id","previousFrame").animate(u,500,function(){s._currentFrame$p$0.dispose&&s._currentFrame$p$0.dispose();s._hostDiv$p$0.find("#previousFrame").hide();s._hostDiv$p$0.find("#previousFrame").remove();s._hostDiv$p$0.css("overflow","hidden")})}this._hostDiv$p$0.find("#nextFrame").attr("id","currentFrame");var f;if($.browser.webkit){this._hostDiv$p$0.find("#currentFrame").css("opacity","1");f=t===1||t===3?{top:"0%"}:{left:"0%"}}else f=t===1||t===3?{top:"0%",opacity:"1"}:{left:"0%",opacity:"1"};var e=this;this._hostDiv$p$0.find("#currentFrame").animate(f,500,function(){e._currentFrame$p$0=n;e._currentFrame$p$0.onLoad&&e._currentFrame$p$0.onLoad();e._isBusy$p$0=!1;e._processPendingFrames$p$0()})},_processPendingFrames$p$0:function(){if(this._pendingFrames$p$0.length>0){var n=Array.dequeue(this._pendingFrames$p$0);this.renderFrame(n.frame,n.animationOrigin,n.isCurtainAnimation)}}};NLG.Common.FrameHost._pendingFrame=function(n,t,i){this.frame=n;this.animationOrigin=t;this.isCurtainAnimation=i};NLG.Common.SuggestedAddress=function(n,t){this.index=t;this.addressText=n};NLG.Common.SuggestedAddress.getBingMapsUrl=function(n){return"http://www.bing.com/maps/?v=2&where1="+window.encodeURIComponent(n)};NLG.Common.SuggestedAddress.prototype={addressText:null,index:null,get_bingMapsUrl:function(){return"http://www.bing.com/maps/?v=2&where1="+window.encodeURIComponent(this.addressText)}};NLG.Common.SuggestedMeeting=function(n,t){this.meetingText=n.meetingString;this.attendees=[];for(var u=0;u<n.attendees.length;u++)this._isCurrentUser$p$0(n.attendees[u].emailAddress)||(this.attendees[this.attendees.length]=n.attendees[u]);this.subject=n.subject;this.location=n.location;this.startTime=new Date(n.start.toString());this.endTime=new Date(n.end.toString());this.index=t;var r=new Date;this.isInPast=this.startTime<r;if(this.isInPast){var f=r.getMinutes();var e=(60-f)%30;this.startTime=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),f+e);this.endTime=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),f+e+30);this.canAutoSchedule=!1}var i=window.UIGlobals.appOm.convertToLocalClientTime(this.startTime);this.uiStartTime=new Date(i.year,i.month,i.date,i.hours,i.minutes,i.seconds);i=window.UIGlobals.appOm.convertToLocalClientTime(this.endTime);this.uiEndTime=new Date(i.year,i.month,i.date,i.hours,i.minutes,i.seconds);this.meetingRangeString=NLG.Common.SuggestedMeeting.generateMeetingRangeString(this.uiStartTime,this.uiEndTime)};NLG.Common.SuggestedMeeting.generateMeetingRangeString=function(n,t){var i=new Sys.StringBuilder;var r=window._u.ExtensionStrings.l_SuggestedMeetingsSingleItemShortTimePattern_Text;var u=window._u.ExtensionStrings.l_SuggestedMeetingsSingleItemLongDatePattern_Text;n.getDate()!==t.getDate()||n.getMonth()!==t.getMonth()||n.getFullYear()!==t.getFullYear()?i.append(n.format(r+" "+u)):i.append(n.format(r));i.append(" - ");i.append(t.format(r+" "+u));return i.toString()};NLG.Common.SuggestedMeeting.prototype={meetingText:null,subject:null,location:null,attendees:null,index:null,startTime:null,endTime:null,uiStartTime:null,uiEndTime:null,meetingRangeString:null,isInPast:!1,canAutoSchedule:!0,hasConflict:!0,hasBeenScheduled:!1,_isCurrentUser$p$0:function(n){return window.UIGlobals.appOm?n===window.UIGlobals.appOm.userProfile.emailAddress:!1}};NLG.Common.SuggestedTask=function(n,t,i){this.taskText=n.taskString;this.assignees=n.assignees;this.index=t;this.isAssignedToCurrentUser=this._setIsAssignedToCurrentUser$p$0(i)};NLG.Common.SuggestedTask.prototype={taskText:null,assignees:null,index:null,isAssignedToCurrentUser:!1,_setIsAssignedToCurrentUser$p$0:function(n){for(var t=0;t<this.assignees.length;t++)if(this.assignees[t].emailAddress===n&&!1)return!0;return!1}};window.UIGlobals=function(){};window.UIGlobals.Initialize=function(n,t){window.UIGlobals.appOm=n;window.UIGlobals._areStringsLoaded$p()||window.UIGlobals._loadStrings$p(t);window.UIGlobals.strings=_u.ExtensionStrings;window.UIGlobals.isRtl=window.UIGlobals._useRtlRendering$p(t)};window.UIGlobals._areStringsLoaded$p=function(){try{var n=_u.ExtensionStrings;return!!n}catch(t){}return!1};window.UIGlobals._loadStrings$p=function(n){var i=!1;var t=n.toLowerCase();do{i=window.UIGlobals._loadStringsScript$p(String.format("../{0}/{1}",t,"microsoft.exchange.clients.owa2.client.extensionstrings.localized.min.js"));if(i)break;t=window.UIGlobals._getParentCulture$p(t)}while(t);i||window.UIGlobals._loadStringsScript$p(window.UIGlobals._fallbackStringScriptPath$p)};window.UIGlobals._getParentCulture$p=function(n){var t=window.UIGlobals._parentCultures$p[n];if(!t){var i=n.lastIndexOf("-");i!==-1&&(t=n.substr(0,i))}return t};window.UIGlobals._loadStringsScript$p=function(n){var i=!1;var t={};t.async=!1;t.type="GET";t.url=n;t.success=function(n,t,r){i=window.UIGlobals._areStringsLoaded$p()};$.ajax(t);return i};window.UIGlobals._useRtlRendering$p=function(n){return n.startsWith("ar")||n.startsWith("he")||n.startsWith("ur")||n.startsWith("fa")||n.startsWith("syr")||n.startsWith("ps")||n.startsWith("dv")||n.startsWith("ug")||n.startsWith("prs")};NLG.Common.SuggestionsUI=function(n,t,i){this.$$d_accessibilityKeydownHandler=Function.createDelegate(this,this.accessibilityKeydownHandler);this.$$d__nextPageBtnClickHandler$p$0=Function.createDelegate(this,this._nextPageBtnClickHandler$p$0);this.$$d__previousPageBtnClickHandler$p$0=Function.createDelegate(this,this._previousPageBtnClickHandler$p$0);this.$$d__itemFrameClickHandler$p$0=Function.createDelegate(this,this._itemFrameClickHandler$p$0);this.$$d_backBtnClickHandler=Function.createDelegate(this,this.backBtnClickHandler);this.$$d__callOnItemDispose$p$0=Function.createDelegate(this,this._callOnItemDispose$p$0);this.$$d__callOnItemLoad$p$0=Function.createDelegate(this,this._callOnItemLoad$p$0);this.$$d__unbindEvents$p$0=Function.createDelegate(this,this._unbindEvents$p$0);this.$$d__bindEvents$p$0=Function.createDelegate(this,this._bindEvents$p$0);window.UIGlobals.Initialize(t,n);this.outlookAppLocale=n;var r=$("#frameHost");var u=$(window).height();r.css("height","100%");this._pageSize$p$0=Math.floor((u-40)/46);this._frameHost$p$0=new NLG.Common.FrameHost(r);this.userActionEvent="click"};NLG.Common.SuggestionsUI.prototype={userActionEvent:null,outlookAppLocale:null,outlookOm:null,_pageSize$p$0:0,_pageNumber$p$0:0,_activeItem$p$0:null,_frameHost$p$0:null,_suggestions$p$0:null,_isPreviousButtonVisible$p$0:!1,_isNextButtonVisible$p$0:!1,_shouldListIconBeVisible$p$0:!0,_shouldItemIconBeVisible$p$0:!1,_isIconVisible$p$0:!1,get_shouldListIconBeVisible:function(){return this._shouldListIconBeVisible$p$0},set_shouldListIconBeVisible:function(n){this._shouldListIconBeVisible$p$0=n;return n},get_shouldItemIconBeVisible:function(){return this._shouldItemIconBeVisible$p$0},set_shouldItemIconBeVisible:function(n){this._shouldItemIconBeVisible$p$0=n;return n},start:function(n){if(n){this._suggestions$p$0=n;var t=this.loadIntroContent();if(t){var r=this;var i=new NLG.Common.Frame("Intro",t,function(){window.setTimeout(function(){r._renderInitialLayout$p$0(!0)},800)},null);this._frameHost$p$0.renderFrame(i,0)}else this._renderInitialLayout$p$0(!1)}},onItemDispose:function(n){},onItemLoad:function(n){},renderListView:function(n,t){this._frameHost$p$0||(this._frameHost$p$0=new NLG.Common.FrameHost($("#frameHost")));$("#suggIconContainer").css("display")==="none"&&$("#suggIconContainer").delay(600).css("display","block").fadeTo(200,1);if(this._suggestions$p$0.length>this._pageSize$p$0){window.UIGlobals.isPagingEnabled=!0;if(this._pageNumber$p$0){if(this._pageNumber$p$0>0){$("#previousPageBtn").css("display","block").stop().fadeTo(500,1);this._isPreviousButtonVisible$p$0=!0}}else{var r=this;$("#previousPageBtn").stop().fadeTo(500,0,function(){$("#previousPageBtn").css("display","none")});this._isPreviousButtonVisible$p$0=!1}if((this._pageNumber$p$0+1)*this._pageSize$p$0<this._suggestions$p$0.length){$("#nextPageBtn").stop().css("display","block").fadeTo(500,1);this._isNextButtonVisible$p$0=!0}else if((this._pageNumber$p$0+1)*this._pageSize$p$0>=this._suggestions$p$0.length){var u=this;$("#nextPageBtn").stop().fadeTo(500,0,function(){$("#nextPageBtn").css("display","none")});this._isNextButtonVisible$p$0=!1}}var i=new NLG.Common.Frame("ListViewFrame",this.loadListViewContent(this._pageNumber$p$0,this._pageSize$p$0),this.$$d__bindEvents$p$0,this.$$d__unbindEvents$p$0);this._frameHost$p$0.renderFrame(i,n,t)},renderItemForm:function(n,t,i){this._frameHost$p$0||(this._frameHost$p$0=new NLG.Common.FrameHost($("#frameHost")));var r=new NLG.Common.Frame("ItemFormFrame",this.loadItemFormContent(n),this.$$d__callOnItemLoad$p$0,this.$$d__callOnItemDispose$p$0);this._frameHost$p$0.renderFrame(r,t,i)},backBtnClickHandler:function(n){this._unbindEvents$p$0();this._shouldListIconBeVisible$p$0&&!this._isIconVisible$p$0?this._expandIconContainer$p$0():!this._shouldListIconBeVisible$p$0&&this._isIconVisible$p$0&&this._closeIconContainer$p$0();$("#backBtn").fadeOut(300);this.renderListView(4)},logDatapoint:function(n){this.outlookOm&&this.outlookOm.recordDataPoint(n)},logError:function(n){if(this.outlookOm){var t={};t.TraceLevel="Error";t.Message=n;this.outlookOm.recordDataPoint(t)}},logWarning:function(n){if(this.outlookOm){var t={};t.TraceLevel="Warning";t.Message=n;this.outlookOm.recordDataPoint(t)}},perfTrackStart:function(n){if(this.outlookOm){var t={Name:n,Event:"Start"};this.outlookOm.trackCtq(t)}},perfTrackEnd:function(n){if(this.outlookOm){var t={Name:n,Event:"End"};this.outlookOm.trackCtq(t)}},transitionFrame:function(n,t){this._frameHost$p$0||(this._frameHost$p$0=new NLG.Common.FrameHost($("#frameHost")));this._frameHost$p$0.renderFrame(n,4,!0)},accessibilityKeydownHandler:function(n){var f=window.jQuery(document.documentElement).find("[tabindex]");var r=f.length;var t=0;var i=window.jQuery(document.activeElement).attr("tabindex");if(i&&i.length>0||window.parseInt(i)>=0){t=window.parseInt(i);var u=window.parseInt(n.which);switch(u){case 13:window.jQuery(document.activeElement).trigger(this.userActionEvent);break;case 37:case 38:t?t--:t=r-1;break;case 39:case 40:t++;break}}$("[tabindex='"+t%r+"']").focus()},_renderInitialLayout$p$0:function(n){$("#suggIconContainer").css("display","block");if(this._suggestions$p$0.length===1){this.renderItemForm(0,n?2:0);this._shouldItemIconBeVisible$p$0&&this._expandIconContainer$p$0()}else{this.renderListView(n?2:0);this._shouldListIconBeVisible$p$0&&this._expandIconContainer$p$0()}},_callOnItemLoad$p$0:function(){$("#backBtn").fadeTo(300,1);this._bindEvents$p$0();this.onItemLoad(this._activeItem$p$0)},_callOnItemDispose$p$0:function(){this._unbindEvents$p$0();this.onItemDispose(this._activeItem$p$0)},_bindEvents$p$0:function(){$("#backBtn").bind(this.userActionEvent,this.$$d_backBtnClickHandler);$(".itemFrame").bind(this.userActionEvent,this.$$d__itemFrameClickHandler$p$0);this._isPreviousButtonVisible$p$0&&$("#previousPageBtn").bind(this.userActionEvent,this.$$d__previousPageBtnClickHandler$p$0);this._isNextButtonVisible$p$0&&$("#nextPageBtn").bind(this.userActionEvent,this.$$d__nextPageBtnClickHandler$p$0);this._refreshAccessibility$p$0()},_unbindEvents$p$0:function(){$("#backBtn").unbind(this.userActionEvent,this.$$d_backBtnClickHandler);$(".itemFrame").unbind(this.userActionEvent,this.$$d__itemFrameClickHandler$p$0);$("#previousPageBtn").unbind(this.userActionEvent,this.$$d__previousPageBtnClickHandler$p$0);$("#nextPageBtn").unbind(this.userActionEvent,this.$$d__nextPageBtnClickHandler$p$0)},_previousPageBtnClickHandler$p$0:function(n){this._unbindEvents$p$0();this._pageNumber$p$0--;this.renderListView(1)},_nextPageBtnClickHandler$p$0:function(n){this._unbindEvents$p$0();this._pageNumber$p$0++;this.renderListView(3)},_itemFrameClickHandler$p$0:function(n){n.stopPropagation();this._unbindEvents$p$0();this._shouldItemIconBeVisible$p$0&&!this._isIconVisible$p$0?this._expandIconContainer$p$0():!this._shouldItemIconBeVisible$p$0&&this._isIconVisible$p$0&&this._closeIconContainer$p$0();var f=this;$("#previousPageBtn").fadeTo(200,0,function(){$("#previousPageBtn").css("display","none")});var u=this;$("#nextPageBtn").fadeTo(200,0,function(){$("#nextPageBtn").css("display","none")});this._isPreviousButtonVisible$p$0=this._isNextButtonVisible$p$0=!1;var t=window.jQuery(n.currentTarget);var i=t.closest("li");var r=window.parseInt(i.attr("id"));this.renderItemForm(r,2);this._activeItem$p$0=t},_refreshAccessibility$p$0:function(){window.jQuery(document.documentElement).unbind("keydown");var n=0;var t=this;$(".itemFrame").each(function(t,i){window.jQuery(i).attr("tabindex",n.toString());n++});if(this._isPreviousButtonVisible$p$0){$("#previousPageBtn").attr("tabindex",n.toString());n++}else $("#previousPageBtn").removeAttr("tabindex");if(this._isNextButtonVisible$p$0){$("#nextPageBtn").attr("tabindex",n.toString());n++}else $("#nextPageBtn").removeAttr("tabindex");window.jQuery(document.documentElement).keydown(this.$$d_accessibilityKeydownHandler)},_expandIconContainer$p$0:function(){var n=$("#suggIconContainer");if($(window).width()<500){n.addClass("suggIconContainerExpanded");n.css("left","0px");n.removeClass("suggIconContainerClosed");this._isIconVisible$p$0=!0}else{n.removeClass("suggIconContainerClosed");var t=this;n.stop().animate({left:"0px"},300,function(){n.addClass("suggIconContainerExpanded");t._isIconVisible$p$0=!0})}},_closeIconContainer$p$0:function(){var n=$("#suggIconContainer");if($(window).width()<500){n.addClass("suggIconContainerClosed");n.css("left","-55px");n.removeClass("suggIconContainerExpanded");this._isIconVisible$p$0=!1}else{n.removeClass("suggIconContainerExpanded");var t=this;n.stop().animate({left:"-55px"},300,function(){n.addClass("suggIconContainerClosed");t._isIconVisible$p$0=!1})}}};NLG.Common.XmlDomDocument=function(){};NLG.Common.XmlDomDocument.fromString=function(n){var i;try{var t=window["new ActiveXObject"]("Msxml2.DOMDocument.6.0");t.async=!1;t.loadXML(n);i=t}catch(u){var r=new DOMParser;i=r.parseFromString(n,"text/xml")}return i};NLG.Common.UpdateItemRequestArgs.registerClass("NLG.Common.UpdateItemRequestArgs");NLG.Common.GetItemFlagStatusArgs.registerClass("NLG.Common.GetItemFlagStatusArgs",null,NLG.Common.IEwsRequestArgs);NLG.Common.SetFlagArgs.registerClass("NLG.Common.SetFlagArgs",null,NLG.Common.IEwsRequestArgs);NLG.Common.EwsHelper.registerClass("NLG.Common.EwsHelper");NLG.Common.Frame.registerClass("NLG.Common.Frame");NLG.Common.FrameHost.registerClass("NLG.Common.FrameHost");NLG.Common.FrameHost._pendingFrame.registerClass("NLG.Common.FrameHost._pendingFrame");NLG.Common.SuggestedAddress.registerClass("NLG.Common.SuggestedAddress");NLG.Common.SuggestedMeeting.registerClass("NLG.Common.SuggestedMeeting");NLG.Common.SuggestedTask.registerClass("NLG.Common.SuggestedTask");NLG.Common.SuggestionsUI.registerClass("NLG.Common.SuggestionsUI");NLG.Common.SuggestedTask.isTaskHighlightingEnabled=!1;window.UIGlobals.isPagingEnabled=!1;window.UIGlobals.strings=null;window.UIGlobals.isRtl=!1;window.UIGlobals.appOm=null;window.UIGlobals._fallbackStringScriptPath$p="../en/microsoft.exchange.clients.owa2.client.extensionstrings.localized.min.js";window.UIGlobals._parentCultures$p={"zh-tw":"zh-hant","zh-cn":"zh-hans","zh-hk":"zh-hant","zh-sg":"zh-hans","zh-mo":"zh-hant",nb:"no","mn-mn":"mn-cyrl",dsb:"hsb",smj:"se",sma:"se",sms:"se",smn:"se"}